
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>random_dw_pw &#8212; random-dw-pw-py 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for random_dw_pw</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">random</span>

<div class="viewcode-block" id="RandomDwPw"><a class="viewcode-back" href="../index.html#random_dw_pw.RandomDwPw">[docs]</a><span class="k">class</span> <span class="nc">RandomDwPw</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for creating diceware passwords</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    word_list_path : str</span>
<span class="sd">        A string containing the path to the diceware wordlist</span>

<span class="sd">    pw_min_length : int</span>
<span class="sd">        Specifies the minimum length for the generated password</span>
<span class="sd">    </span>
<span class="sd">    pw_max_length : int</span>
<span class="sd">        (Optional) Specifies the maximum length for the generated password. If not specified, the generated password will simply have random words added until the minimum length is specified. If a maximum length is specified, random words will be truncated to meet this requirement</span>
<span class="sd">    </span>
<span class="sd">    num_capitals : int</span>
<span class="sd">        (Optional) Specifies the minimum number of capitals in the generated password. If not specified, defaults to 0.</span>

<span class="sd">    num_spec_chars : int</span>
<span class="sd">        (Optional) Specifies the minimum number of required special characters in the generated password. If not specified, defaults to 0.</span>

<span class="sd">    num_numbers : int</span>
<span class="sd">        (Optional) Specifies the minimum number of numbers required in the generated password. If not specified, defaults to 0.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    __word_list : str[]</span>
<span class="sd">        A list of strings containing a diceware wordlist</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word_list_path</span><span class="p">,</span> <span class="n">pw_min_length</span><span class="p">,</span> <span class="n">pw_max_length</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> \
    <span class="n">num_capitals</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_spec_chars</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_numbers</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">word_list_path</span> <span class="o">=</span> <span class="n">word_list_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pw_min_length</span> <span class="o">=</span> <span class="n">pw_min_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pw_max_length</span> <span class="o">=</span> <span class="n">pw_max_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_capitals</span> <span class="o">=</span> <span class="n">num_capitals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_spec_chars</span> <span class="o">=</span> <span class="n">num_spec_chars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_numbers</span> <span class="o">=</span> <span class="n">num_numbers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__spec_char_pool</span> <span class="o">=</span> <span class="p">{</span> \
            <span class="mi">0</span> <span class="p">:</span> <span class="s1">&#39;!&#39;</span><span class="p">,</span> \
            <span class="mi">1</span> <span class="p">:</span> <span class="s1">&#39;@&#39;</span><span class="p">,</span> \
            <span class="mi">2</span> <span class="p">:</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> \
            <span class="mi">3</span> <span class="p">:</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span> \
            <span class="mi">4</span> <span class="p">:</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> \
            <span class="mi">5</span> <span class="p">:</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> \
            <span class="mi">6</span> <span class="p">:</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> \
            <span class="mi">7</span> <span class="p">:</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> \
            <span class="mi">8</span> <span class="p">:</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> \
            <span class="mi">9</span> <span class="p">:</span> <span class="s1">&#39;)&#39;</span> \
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_word_list</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__load_word_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__word_list</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">word_list_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;^[0-9][0-9][0-9][0-9][0-9][\s]+.+$&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
                    <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__word_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__dice_roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__get_random_word</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">random_number</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># create random number by roll dice 5 times</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">random_number</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dice_roll</span><span class="p">())</span>
        <span class="c1"># convert string to int</span>
        <span class="n">random_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">random_number</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__word_list</span><span class="p">[</span><span class="n">random_number</span><span class="p">]</span>


<div class="viewcode-block" id="RandomDwPw.generate_easy_dw_pw"><a class="viewcode-back" href="../index.html#random_dw_pw.RandomDwPw.generate_easy_dw_pw">[docs]</a>    <span class="k">def</span> <span class="nf">generate_easy_dw_pw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates an &#39;easy&#39; diceware password, meaning one that sacrifices some security so that it is convenient to type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        (None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        diceware_password : String</span>
<span class="sd">            The string returned is a diceware password, a list of words separated by strings. If capitals are specified, random letters will be capitalized. If numbers or special characters are specified, they will be inserted at random locations either in front of or after a word.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">curr_pw</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">curr_word_array</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">curr_pw_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">curr_num_spec_chars</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">curr_num_nums</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">added_spec_chars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">added_nums</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="n">curr_pw_len</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_capitals</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pw_min_length</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_random_word</span><span class="p">()</span>
            <span class="n">curr_word_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="c1"># matches = re.findall(&quot;the&quot;, &quot;the ether etheo eth thathe the&quot;)</span>
            <span class="n">num_spec_chars_in_word</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[^0-9a-zA-Z]&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">))</span>
            <span class="n">num_numbers_in_word</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[0-9]&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">))</span>

            <span class="n">curr_num_spec_chars</span> <span class="o">+=</span> <span class="n">num_spec_chars_in_word</span>
            <span class="n">curr_num_nums</span> <span class="o">+=</span> <span class="n">num_numbers_in_word</span>

            <span class="n">curr_pw_len</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="c1"># satisfy requirement for number of special characters</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_spec_chars</span> <span class="o">&gt;</span> <span class="n">curr_num_spec_chars</span><span class="p">:</span>
            <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">rand_ind</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_word_array</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">before_or_after</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">rand_spec_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spec_char_pool</span><span class="p">[</span><span class="n">rand_num</span><span class="p">]</span>
            <span class="n">added_spec_chars</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rand_ind</span><span class="p">,</span> <span class="n">before_or_after</span><span class="p">,</span> <span class="n">rand_spec_char</span><span class="p">])</span>
            <span class="n">curr_num_spec_chars</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># number of numbers</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_numbers</span> <span class="o">&gt;</span> <span class="n">curr_num_nums</span><span class="p">:</span>
            <span class="n">rand_num</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">rand_ind</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_word_array</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">before_or_after</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">added_nums</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rand_ind</span><span class="p">,</span> <span class="n">before_or_after</span><span class="p">,</span> <span class="n">rand_num</span><span class="p">])</span>
            <span class="n">curr_num_nums</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># construct password</span>
        <span class="k">for</span> <span class="n">injection_list</span> <span class="ow">in</span> <span class="p">[</span><span class="n">added_nums</span><span class="p">,</span> <span class="n">added_spec_chars</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">item_injection</span> <span class="ow">in</span> <span class="n">injection_list</span><span class="p">:</span>
                <span class="n">rand_ind</span><span class="p">,</span> <span class="n">before_or_after</span><span class="p">,</span> <span class="n">rand_inj</span> <span class="o">=</span> <span class="n">item_injection</span>

                <span class="k">if</span> <span class="n">before_or_after</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">curr_word_array</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rand_inj</span><span class="p">)</span> <span class="o">+</span> <span class="n">curr_word_array</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">curr_word_array</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr_word_array</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rand_inj</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curr_word_array</span><span class="p">)):</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">curr_word_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">curr_pw</span> <span class="o">+=</span> <span class="n">token</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_word_array</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">curr_pw</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>

        <span class="c1"># number of capitals</span>
        <span class="n">num_letters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[a-z]&quot;</span><span class="p">,</span> <span class="n">curr_pw</span><span class="p">))</span>

        <span class="c1"># catch errors</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pw_max_length</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_capitals</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pw_max_length</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_capitals</span> <span class="o">&gt;</span> <span class="n">num_letters</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Error generating password: Requiring too many capital letters for the specified password length. Change parameters and try again.&#39;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="n">curr_caps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">curr_caps</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_capitals</span><span class="p">:</span>
            <span class="n">rand_ind</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_pw</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">pw_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">curr_pw</span><span class="p">)</span>
            <span class="n">pw_list</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr_pw</span><span class="p">[</span><span class="n">rand_ind</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">curr_pw</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pw_list</span><span class="p">)</span>
            <span class="n">curr_caps</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">curr_pw</span></div></div>
















</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">random-dw-pw-py</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, scMarth.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>